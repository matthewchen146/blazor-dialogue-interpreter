<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>blazor-dialogue-interpreter</title>
    <base href="/" />
    <!-- <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" /> -->
    <link href="css/app.css" rel="stylesheet" />
    <link rel="icon" type="image/png" href="favicon.png" />
    <link href="blazor-dialogue-interpreter.styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="script-style.css">
</head>

<body>
    <main>
        <section class="editor">
            <section class="editor-hbox">
                <section class="editor-window script-window">
                    <div class="editor-toolbar">
                        <button id="download">Download</button>
                        <button id="import">Import</button>
                    </div>
                    <div class="script-container">
                        <pre class="script" contenteditable="true" spellcheck="false"></pre>
                    </div>
                </section>
                <section class="editor-vbox">
                    <section class="editor-window test-window">
                        <div class="editor-toolbar">
                            <button id="run">Run Conversation</button>
                            <select id="conversation"></select>
                        </div>
                    </section>
                    <section class="editor-window log-window">
                        <div class="editor-toolbar">
                            <button id="log-clear">Clear</button>
                        </div>
                        <div class="log-container">
                            <pre class="log"></pre>
                        </div>
                    </section>
                </section>
            </section>
            
            <!-- <section class="editor-column left">
                <div class="script-tools toolbar">
                    <button id="download">Download</button>
                    <button id="import">Import</button>
                </div>
                <div class="script-container">
                    <pre class="script-view" contenteditable="true" spellcheck="false"></pre>
                </div>
            </section>
    
            <section class="editor-column right">
                <div class="test">
                    <div class="dialogue-container">
                        <div class="dialogue-header">
                            <div class="speaker-label">Speaker</div>
                        </div>
                        <div class="dialogue-box">dialogue box</div>
                        <div class="dialogue-footer">
                            <button class="next-button" id="next">Next</button>
                        </div>
                    </div>
                    <div class="options-container">
    
                    </div>
                    <div class="test-tools toolbar">
                        <button id="run">Run</button>
                        <select class="conversation-selector"></select>
                    </div>
                </div>
    
                <div class="log-container">
                    <pre class="log"></pre>
                    <div class="log-tools toolbar">
                        <button class="log-clear" id="log-clear">Clear</button>
                    </div>
                </div>
            </section> -->
        </section> 
    </main>
    <script src="./editor.js"></script>
    <script src="./index.js"></script>
    <script>

        // const editorHContainers = document.querySelectorAll('.editor-hbox>*:nth-child(n+2)');
        // console.log(editorHContainers);

        


        window.dotNetReferenceMap = new Map();

        window.setDotNetReference = (id, reference) => {
            window.dotNetReferenceMap.set(id, reference);
        }

        window.getDotNetReference = (id) => {
            return window.dotNetReferenceMap.get(id);
        }

        window.callDotNetReferenceMethod = async (id, method, ...args) => {
            const reference = window.getDotNetReference(id);
            let result;
            if (reference) {
                result = await reference.invokeMethodAsync(method, ...args);
            }
            return result;
        }

        const AsyncFunction = Object.getPrototypeOf(async function(){}).constructor;

        window.callFunction = async (functionString) => {
            let result;
            try {
                const func = new AsyncFunction(functionString);
                result = await func();
            } catch (error) {
                console.log("window.callFunction", error);
            }
            return result;
        }

    </script>
    <div id="app" style="pointer-events: none;">
        <svg class="loading-progress">
            <circle r="40%" cx="50%" cy="50%" />
            <circle r="40%" cx="50%" cy="50%" />
        </svg>
        <div class="loading-progress-text"></div>
    </div>

    <div id="blazor-error-ui">
        An unhandled error has occurred.
        <a href="" class="reload">Reload</a>
        <a class="dismiss">ðŸ—™</a>
    </div>
    <script src="_framework/blazor.webassembly.js"></script>
</body>

</html>
